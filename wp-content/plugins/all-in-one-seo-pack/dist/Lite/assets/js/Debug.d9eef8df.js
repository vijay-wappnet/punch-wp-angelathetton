import{ad as E,b as x,x as H,V as N,d as Y}from"./app-core.61d75c0b.js";import{B as R}from"./Checkbox.02461d14.js";import{_ as y}from"./_plugin-vue_export-helper.eefbdd86.js";import{_ as k,a as v}from"./vendor-other.2cdd5822.js";import{as as a,f as s,i as l,O as S,ad as C,a0 as p,R as c,ae as f,U as m,j as d,Q as w,M,v as O,S as V,T as $}from"./vendor-vue-ui.d70c869f.js";import{C as z}from"./Index.104764b8.js";import{C as W}from"./Card.357796d1.js";import{C as K}from"./Tabs.eadf9edf.js";import{C as P}from"./Index.67f2fc23.js";import{C as G}from"./NetworkSiteSelector.ad9eb8a0.js";import{C as j}from"./SettingsRow.483d3796.js";import{G as F,a as q}from"./Row.0a3f58c3.js";import{D as Q}from"./vendor-datetime.430013a3.js";import{S as J}from"./Close.cee3494e.js";import"./vendor-lodash.f9514987.js";import"./Checkmark.8da35047.js";import"./Tooltip.7f0ce0d2.js";import"./Caret.c4a084e6.js";import"./Trash.effd183e.js";import"./Slide.4a56936c.js";import"./Button.7fa2ada4.js";import"./ProBadge.3cd57c7c.js";import"./Information.c3ceadd3.js";import"./Network.75a8df39.js";const B="all-in-one-seo-pack",X={emits:["update"],setup(){return{rootStore:x(),addonsStore:E()}},components:{BaseCheckbox:R},props:{loading:Boolean,disabled:Boolean},data(){return{selectedAddons:{},strings:{runAction:k("Run Action",B),noAddons:k("There are no active addons at the moment.",B)}}},computed:{activeAddons(){return this.addonsStore.addons.filter(t=>t.isActive)},selectedSkus(){return Object.keys(this.selectedAddons).filter(t=>this.selectedAddons[t])},selectedAddonsNames(){return this.activeAddons.filter(t=>this.selectedSkus.includes(t.sku)).map(t=>t.name)}}},Z={class:"aioseo-addons-list"},ee={key:1};function te(t,e,i,g,o,r){const u=a("base-checkbox"),b=a("base-button");return s(),l("div",Z,[r.activeAddons.length>0?(s(),l(S,{key:0},[(s(!0),l(S,null,C(r.activeAddons,(h,A)=>(s(),l("div",{key:A},[p(u,{size:"medium",modelValue:o.selectedAddons[h.sku],"onUpdate:modelValue":_=>o.selectedAddons[h.sku]=_,disabled:i.disabled},{default:c(()=>[f(m(h.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]))),128)),d("div",null,[p(b,{type:"blue",size:"medium",onClick:e[0]||(e[0]=h=>(t.$emit("update",r.selectedSkus),t.$emit("addons-selected",r.selectedAddonsNames))),loading:i.loading,disabled:i.disabled||r.selectedSkus.length===0},{default:c(()=>[f(m(o.strings.runAction),1)]),_:1},8,["loading","disabled"])])],64)):(s(),l("b",ee,m(o.strings.noAddons),1))])}const oe=y(X,[["render",te],["__scopeId","data-v-a1f4dc34"]]),se="all-in-one-seo-pack",ne={emits:["update"],setup(){return{rootStore:x()}},components:{BaseCheckbox:R,GridColumn:q,GridRow:F},props:{loading:Boolean,disabled:Boolean},data(){return{options:{},strings:{updateOptions:k("Update Options",se)}}},mounted(){this.rootStore.aioseo.deprecatedOptions.forEach(t=>{t.enabled&&(this.options[t.value]=!0)})}},ie={class:"aioseo-deprecated-options"};function re(t,e,i,g,o,r){const u=a("base-checkbox"),b=a("grid-column"),h=a("grid-row"),A=a("base-button");return s(),l("div",ie,[p(h,{class:"settings"},{default:c(()=>[(s(!0),l(S,null,C(g.rootStore.aioseo.deprecatedOptions,(_,T)=>(s(),w(b,{key:T,xl:"6",sm:"12"},{default:c(()=>[p(u,{size:"medium",modelValue:o.options[_.value],"onUpdate:modelValue":L=>o.options[_.value]=L,disabled:i.disabled},{default:c(()=>[f(m(_.label),1)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024))),128))]),_:1}),e[1]||(e[1]=d("br",null,null,-1)),p(A,{type:"blue",size:"medium",onClick:e[0]||(e[0]=_=>t.$emit("update",o.options)),loading:i.loading,disabled:i.disabled},{default:c(()=>[f(m(o.strings.updateOptions),1)]),_:1},8,["loading","disabled"]),e[2]||(e[2]=d("br",null,null,-1)),e[3]||(e[3]=d("br",null,null,-1))])}const ae=y(ne,[["render",re]]),le={setup(){return{optionsStore:H()}},computed:{infoItems(){return[{label:"Migrated Version",value:this.optionsStore.internalOptions.internal.migratedVersion},{label:"First Activated",value:this.optionsStore.internalOptions.internal.firstActivated!==0?Q.fromMillis(this.optionsStore.internalOptions.internal.firstActivated*1e3).toFormat("MMMM d, yyyy"):!1}]}}},de={class:"v3-migration-info aioseo-description"},ce={class:"info-items"},ue={key:0},pe={key:1};function me(t,e,i,g,o,r){return s(),l("div",de,[d("ul",ce,[(s(!0),l(S,null,C(r.infoItems,(u,b)=>(s(),l("li",{key:b},[u.value?(s(),l("span",ue,m(u.label),1)):M("",!0),u.value?(s(),l("span",pe,m(u.value),1)):M("",!0)]))),128))])])}const ge=y(le,[["render",me]]),he={class:"aioseo-writing-assistant"},be={__name:"WritingAssistant",setup(t){const e=N(),i="all-in-one-seo-pack",g={resetLogins:k("Reset SEOBoost Logins",i)};let o=!1;const r=()=>{confirm(k("Are you sure you want to reset SEOBoost logins?",i))&&(o=!0,e.doTask({action:"aioseo-reset-seoboost-logins"}).finally(()=>{alert(k("SEOBoost logins have been reset.",i)),o=!1}))};return(u,b)=>{const h=a("base-button");return s(),l("div",he,[p(h,{type:"blue",size:"medium",onClick:r,loading:O(o),disabled:O(o)},{default:c(()=>[f(m(g.resetLogins),1)]),_:1},8,["loading","disabled"])])}}},_e={setup(){return{rootStore:x(),toolsStore:N()}},components:{AddonsList:oe,CoreAlert:z,CoreCard:W,CoreMainTabs:K,CoreModal:P,CoreNetworkSiteSelector:G,CoreSettingsRow:j,DeprecatedOptions:ae,MigrationInfo:ge,SvgClose:J,WritingAssistant:be},props:{extraActions:{type:Array,required:!1}},data(){return{site:{},tabsKey:0,doingActionKey:0,activeTab:"general",currentAction:"",currentData:{},showAreYouSureModal:!1,doingAction:[],selectedAddonsNames:[],strings:{selectSite:"Select Site",cardLabel:"Debug",selectLabel:"Select a Debug Action:",buttonLabel:"Run Action",alertWarning:"Before you run any action, please make sure that you have fully read the description and understand the consequences as these cannot be reverted.",cannotBeUndone:"This action cannot be undone.",yesDoAction:"Yes, run this action",noChangedMind:"No, I changed my mind"},alertLink:Y.getPlainLink("Click here to open to the Scheduled Actions panel",this.rootStore.aioseo.urls.admin.scheduledActions,!0)}},computed:{areYouSureTitle(){return this.currentAction.slug==="rerun-addon-migrations"?v('Are you sure you want to run the "%1$s" action for the following addons?<div class="selected-addons-list">%2$s</div>',this.currentAction.label,`<ul>${this.selectedAddonsNames.map(t=>`<li>${t}</li>`).join("")}</ul>`):`Are you sure you want to run the "${this.currentAction.label}" action?`},tabs(){const t=v('<a href="%1$s" target="_blank">Scheduled Actions</a>',this.rootStore.aioseo.urls.admin.scheduledActions),e=this.rootStore.aioseo.data.isNetworkAdmin?"<br><strong>NOTE: If no site is selected, this will clear the network cache.</strong>":"",i=this.rootStore.aioseo.data.isNetworkAdmin?"<br><strong>NOTE: If no site is selected, this will clear the network plugin updates transient.</strong>":"";return[{slug:"general",name:"General",actions:[{label:"Clear Cache",slug:"clear-cache",shortDescription:`This action deletes all records of the <code>aioseo_cache</code> table in the database.${e}`,longDescription:"",showModal:!1,network:!0},{label:"Clear Plugin Updates Transient",slug:"clear-plugin-updates-transient",shortDescription:`This action clears the plugin updates transient, which forces WordPress Core to check for plugin updates.${i}`,longDescription:"",showModal:!1,network:!0},{label:"Readd Capabilities",slug:"readd-capabilities",shortDescription:"This action will readd our capabilities (access permissions) for all users.",longDescription:"",showModal:!1},{label:"Reset Data",slug:"reset-data",shortDescription:"This action will <strong>delete</strong> all our custom tables and options.",longDescription:"",showModal:!0}]},{slug:"sitemap",name:"Sitemap",actions:[{label:"Clear Image Data",slug:"clear-image-data",shortDescription:"This action removes all image data from the database, forcing a site-wide rescan via Action Scheduler.",longDescription:v("To speed up the image scan, go to %1$s and run the <code>aioseo_image_sitemap_scan</code> action.",t),showModal:!1}]},{slug:"migrations",name:"Migrations",actions:[{label:"Rerun V4+ Migrations",slug:"rerun-migrations",shortDescription:"This action will rerun all update migrations since 4.0.0, excluding the V3 migration.",longDescription:"",showModal:!0},{label:"Rerun Migrations for Active Addons",slug:"rerun-addon-migrations",shortDescription:"This action will rerun all update migrations for the selected addons.",longDescription:"",showModal:!0,component:"addons-list"}]},{slug:"old-issues",name:"Old Issues",actions:[{label:"Remove Duplicates",slug:"remove-duplicates",shortDescription:"This action will delete any duplicate records that are found in the <code>aioseo_posts</code> and <code>aioseo_terms</code> tables.",longDescription:"",showModal:!1},{label:"Unescape Data",slug:"unescape-data",shortDescription:"This action will clean <code>aioseo_posts</code> and <code>aioseo_term</code> records whose data is corrupted.",longDescription:v("The action will trigger a routine which runs in batches via Action Scheduler. It may take some time for this routine to complete, To speed up this process, go to %1$s and run the <code>aioseo_unslash_escaped_data_posts</code> or <code>aioseo_unslash_escaped_data_terms</code> action.",t),showModal:!1}]},{slug:"deprecated-options",name:"Deprecated Options",actions:[{label:"Deprecated Options",slug:"deprecated-options",shortDescription:"Enable or disable any options that have been deprecated in AIOSEO.",longDescription:"<strong>These options are not guaranteed to work and all support has been dropped.</strong>",showModal:!1,component:"deprecated-options"}]},{slug:"writing-assistant",name:"Writing Assistant",actions:[{label:"Writing Assistant",slug:"writing-assistant",shortDescription:"Resets all users SEOBoost logins.",longDescription:"",showModal:!1,component:"writing-assistant"}]}]},activeTabObject(){return this.tabs.find(t=>t.slug===this.activeTab)}},methods:{isActionDisabled(t){return this.rootStore.aioseo.data.isNetworkAdmin?this.site.blog_id?this.site.blog_id==="network"&&t.network?!1:this.site.blog_id==="network"&&!t.network:!0:!1},isLoading(t){return!!this.doingAction[t.slug]},getSelectedActionObject(t){let e=null;return this.actions.forEach(i=>{const g=i.options.find(o=>o.value===t);g&&(e=g)}),e},maybeDoAction(t,e){if(this.currentAction=t,this.currentData=e,t.showModal){this.showAreYouSureModal=!0;return}this.doAction(e)},doAction(t){this.doingAction[this.currentAction.slug]=!0,this.showAreYouSureModal=!1,this.doingActionKey++,this.toolsStore.doTask({action:this.currentAction.slug,siteId:this.site.blog_id||this.rootStore.aioseo.data.currentBlogId,data:t}).then(()=>{console.log(`Action "${this.currentAction.label}" has been completed.`)}).catch(e=>{console.error(`Action "${this.currentAction.label}" could not be completed: `,e)}).finally(()=>{this.doingAction[this.currentAction.slug]=!1,this.doingActionKey++})}},beforeMount(){let t=-1;if(this.rootStore.aioseo.data.v3Options&&(t=this.tabs.findIndex(e=>e.slug.toLowerCase()==="migrations"),t!==-1)){const e=v('<a href="%1$s" target="_blank">Scheduled Actions</a>',this.rootStore.aioseo.urls.admin.scheduledActions);this.tabs[t].actions.push({label:"Rerun V3 Migration",slug:"restart-v3-migration",shortDescription:"This action restarts the migration from V3 to V4.",longDescription:v("All settings will be migrated immediately. However, the post/term meta needs to be migrated via a routine which runs in batches via Action Scheduler. To speed up the post/term meta migration, go to %1$s and run the <code>aioseo_migrate_post_meta</code> or <code>aioseo_migrate_term_meta</code> action.",e),infoComponent:"MigrationInfo",showModal:!0})}this.extraActions?.length&&this.extraActions.forEach(e=>{if(t=this.tabs.findIndex(i=>i.slug.toLowerCase()===e.slug.toLowerCase()),t!==-1){this.tabs[t].actions=this.tabs[t].actions.concat(e.actions);return}this.tabs.push(e)})}},fe={class:"aioseo-tools-debug"},Ae={key:0,class:"aioseo-settings-row"},we={class:"select-site"},ve=["innerHTML"],ke=["innerHTML"],Se=["innerHTML"],ye={class:"aioseo-modal-body"},De=["innerHTML"],Me=["innerHTML"];function Ce(t,e,i,g,o,r){const u=a("core-network-site-selector"),b=a("core-alert"),h=a("core-main-tabs"),A=a("base-button"),_=a("core-settings-row"),T=a("svg-close"),L=a("core-modal"),I=a("core-card");return s(),l("div",fe,[p(I,{slug:"debug","header-text":o.strings.cardLabel},{default:c(()=>[g.rootStore.aioseo.data.isNetworkAdmin?(s(),l("div",Ae,[d("div",we,m(o.strings.selectSite),1),p(u,{onSelectedSite:e[0]||(e[0]=n=>o.site=n),"show-network":""})])):M("",!0),p(b,{type:"yellow"},{default:c(()=>[d("div",null,m(o.strings.alertWarning),1),d("div",{innerHTML:o.alertLink},null,8,ve)]),_:1}),(s(),w(h,{internal:"",key:o.tabsKey,tabs:r.tabs,active:o.activeTab,showSaveButton:!1,onChanged:e[1]||(e[1]=n=>o.activeTab=n)},null,8,["tabs","active"])),(s(!0),l(S,null,C(r.activeTabObject.actions,(n,U)=>(s(),w(_,{key:o.activeTab+U,name:n.label,align:""},{content:c(()=>[n.component?(s(),w(V(n.component),{key:0,onUpdate:D=>r.maybeDoAction(n,D),onAddonsSelected:e[2]||(e[2]=D=>o.selectedAddonsNames=D),loading:o.doingAction[n.slug],disabled:r.isActionDisabled(n)},null,40,["onUpdate","loading","disabled"])):(s(),w(A,{type:"blue",size:"medium",onClick:D=>r.maybeDoAction(n),loading:o.doingAction[n.slug],key:o.doingActionKey,disabled:r.isActionDisabled(n)},{default:c(()=>[f(m(o.strings.buttonLabel),1)]),_:1},8,["onClick","loading","disabled"])),d("div",{class:"aioseo-description",innerHTML:n.shortDescription},null,8,ke),d("div",{class:"aioseo-description",innerHTML:n.longDescription},null,8,Se),n.infoComponent?(s(),w(V(n.infoComponent),{key:2})):M("",!0)]),_:2},1032,["name"]))),128)),p(L,{show:o.showAreYouSureModal,"no-header":"",onClose:e[7]||(e[7]=n=>o.showAreYouSureModal=!1),classes:["aioseo-debug-modal"]},{body:c(()=>[d("div",ye,[d("button",{class:"close",onClick:e[4]||(e[4]=$(n=>o.showAreYouSureModal=!1,["stop"]))},[p(T,{onClick:e[3]||(e[3]=n=>o.showAreYouSureModal=!1)})]),d("h3",{innerHTML:r.areYouSureTitle},null,8,De),d("div",{class:"description",innerHTML:o.strings.cannotBeUndone},null,8,Me),p(A,{type:"blue",size:"medium",onClick:e[5]||(e[5]=n=>r.doAction(o.currentData))},{default:c(()=>[f(m(o.strings.yesDoAction),1)]),_:1}),p(A,{type:"gray",size:"medium",onClick:e[6]||(e[6]=n=>o.showAreYouSureModal=!1)},{default:c(()=>[f(m(o.strings.noChangedMind),1)]),_:1})])]),_:1},8,["show"])]),_:1},8,["header-text"])])}const Te=y(_e,[["render",Ce]]),Le={components:{Debug:Te}};function xe(t,e,i,g,o,r){const u=a("debug",!0);return s(),w(u)}const tt=y(Le,[["render",xe]]);export{tt as default};
