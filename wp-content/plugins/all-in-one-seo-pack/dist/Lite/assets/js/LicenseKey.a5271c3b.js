import{M as A,d as E,v as O,b as U,x as H,k as M,N as B}from"./app-core.61d75c0b.js";import{u as N}from"./Wizard.9c55bdc9.js";import{C as V}from"./Index.104764b8.js";import{G as D,a as G}from"./Row.0a3f58c3.js";import{S as I}from"./Checkmark.8da35047.js";import{W as R,a as F,b as Y}from"./Header.3efd7fa7.js";import{W as j}from"./CloseAndExit.c9475def.js";import{_ as q}from"./Steps.be028913.js";import{_ as J}from"./_plugin-vue_export-helper.eefbdd86.js";import{m as Q}from"./vendor-lodash.f9514987.js";import{_ as o,a as l}from"./vendor-other.2cdd5822.js";import{as as s,f as d,i as _,a0 as i,R as a,j as c,U as h,M as g,O as X,ad as Z,Q as S,ae as u}from"./vendor-vue-ui.d70c869f.js";import"./vendor-datetime.430013a3.js";import"./Close.cee3494e.js";import"./Logo.2969769f.js";import"./Index.67f2fc23.js";const r="all-in-one-seo-pack",$={setup(){const{getSelectedUpsellFeatures:e,strings:t}=N({stage:"license-key"});return{composableStrings:t,connectStore:B(),getSelectedUpsellFeatures:e,licenseStore:M(),optionsStore:H(),rootStore:U(),setupWizardStore:O()}},components:{CoreAlert:V,GridColumn:G,GridRow:D,SvgCheckmark:I,WizardBody:Y,WizardCloseAndExit:j,WizardContainer:F,WizardHeader:R,WizardSteps:q},data(){return{error:null,loading:!1,localLicenseKey:null,strings:Q(this.composableStrings,{enterYourLicenseKey:l(o("Enter your %1$s License Key",r),"AIOSEO"),boldText:l("<strong>%1$s %2$s</strong>","AIOSEO","Lite"),purchasedBoldText:l("<strong>%1$s %2$s</strong>","AIOSEO","Pro"),linkText:l(o("upgrade to %1$s",r),"Pro"),placeholder:o("Paste your license key here",r),connect:o("Connect",r)})}},watch:{localLicenseKey(e){this.setupWizardStore.licenseKey=e}},computed:{noLicenseNeeded(){return l(o("You're using %1$s - no license needed. Enjoy!",r)+" ðŸ™‚",this.strings.boldText)},link(){return l('<strong><a href="%1$s" target="_blank">%2$s</a></strong>',E.getUpsellUrl("general-settings","license-box","liteUpgrade"),this.strings.linkText)},tooltipText(){return this.rootStore.isPro?o("To unlock the selected features, please enter your license key below.",r):l(o("To unlock the selected features, please %1$s and enter your license key below.",r),this.link)},alreadyPurchased(){return l(o("Already purchased? Simply enter your license key below to connect with %1$s!",r),this.strings.purchasedBoldText)}},methods:{processConnectOrActivate(){if(this.rootStore.isPro)return this.processActivateLicense();this.processGetConnectUrl()},processActivateLicense(){this.error=null,this.loading=!0,this.rootStore.loading=!0,this.licenseStore.activate(this.localLicenseKey).then(()=>{this.optionsStore.internalOptions.internal.license.expired=!1,this.setupWizardStore.saveWizard("license-key").then(()=>{this.$router.push(this.setupWizardStore.getNextLink)})}).catch(e=>{if(this.loading=!1,this.localLicenseKey=null,this.rootStore.loading=!1,!e||!e.response||!e.response.body||!e.response.body.error||!e.response.body.licenseData){this.error=o("An unknown error occurred, please try again later.",r);return}const t=e.response.body.licenseData;if(t.invalid){this.error=o("The license key provided is invalid. Please use a different key to continue receiving automatic updates.",r);return}if(t.disabled){this.error=o("The license key provided has been suspended. Please use a different key to continue receiving automatic updates. (Error Code AH12BGDT45D9)",r);return}if(t.domainDisabled){this.error=o("The license key provided cannot be used for this domain as it has been disabled. Please use a different key to continue receiving automatic updates, or contact our support team for more information. (Error Code RW94KXEO54I2)",r);return}if(t.expired){this.error=this.licenseKeyExpired;return}if(t.activationsError){this.error=o("This license key has reached the maximum number of activations. Please deactivate it from another site, or upgrade your license to continue receiving automatic updates. (Error Code ZL53IPPJ80RF)",r);return}(t.connectionError||t.requestError)&&(this.error=o("There was an error connecting to the licensing API. Please try again later.",r))})},processGetConnectUrl(){this.loading=!0,this.rootStore.loading=!0,this.connectStore.getConnectUrl({key:this.localLicenseKey,wizard:!0}).then(e=>{if(e.body.url){if(!e.body.popup)return this.loading=!1,this.rootStore.loading=!1,window.open(e.body.url);this.openPopup(e.body.url)}})},openPopup(e){A(e,"_self",600,630,!0,["file","token"],this.completedCallback,this.closedCallback)},completedCallback(e){return e.wizard=!0,this.connectStore.processConnect(e)},closedCallback(e){if(e)return window.location.reload();this.loading=!1,this.rootStore.loading=!1},skipStep(){const e=this.setupWizardStore.getNextLink;this.setupWizardStore.currentStage=e.name,this.setupWizardStore.saveWizard().then(()=>{this.$router.push(e)})}},mounted(){this.localLicenseKey=this.setupWizardStore.licenseKey}},ee={class:"aioseo-wizard-license-key"},te={class:"header"},oe=["innerHTML"],re={class:"license-cta-box"},ne=["innerHTML"],se=["innerHTML"],ie={class:"license-key"},ae={class:"go-back"};function le(e,t,ce,p,n,m){const b=s("wizard-header"),L=s("wizard-steps"),v=s("svg-checkmark"),z=s("grid-column"),w=s("grid-row"),x=s("base-input"),f=s("base-button"),C=s("core-alert"),k=s("router-link"),T=s("wizard-body"),P=s("wizard-close-and-exit"),W=s("wizard-container");return d(),_("div",ee,[i(b),i(W,null,{default:a(()=>[i(T,null,{footer:a(()=>[c("div",ae,[i(k,{to:p.setupWizardStore.getPrevLink,class:"no-underline"},{default:a(()=>[...t[2]||(t[2]=[u("â†",-1)])]),_:1},8,["to"]),t[3]||(t[3]=u(" Â  ",-1)),i(k,{to:p.setupWizardStore.getPrevLink},{default:a(()=>[u(h(n.strings.goBack),1)]),_:1},8,["to"])]),t[4]||(t[4]=c("div",{class:"spacer"},null,-1)),i(f,{type:"gray",onClick:m.skipStep},{default:a(()=>[u(h(n.strings.skipThisStep),1)]),_:1},8,["onClick"])]),default:a(()=>[i(L),c("div",te,h(n.strings.enterYourLicenseKey),1),p.rootStore.isPro?g("",!0):(d(),_("div",{key:0,class:"description",innerHTML:m.noLicenseNeeded},null,8,oe)),c("div",re,[c("div",{innerHTML:m.tooltipText},null,8,ne),i(w,null,{default:a(()=>[(d(!0),_(X,null,Z(p.getSelectedUpsellFeatures,(y,K)=>(d(),S(z,{sm:"6",key:K},{default:a(()=>[i(v),u(" "+h(y.name),1)]),_:2},1024))),128))]),_:1})]),p.rootStore.isPro?g("",!0):(d(),_("div",{key:1,innerHTML:m.alreadyPurchased},null,8,se)),c("form",ie,[t[1]||(t[1]=c("input",{type:"text",name:"username",autocomplete:"username",style:{display:"none"}},null,-1)),i(x,{type:"password",placeholder:n.strings.placeholder,"append-icon":n.localLicenseKey?"circle-check":null,autocomplete:"new-password",modelValue:n.localLicenseKey,"onUpdate:modelValue":t[0]||(t[0]=y=>n.localLicenseKey=y)},null,8,["placeholder","append-icon","modelValue"]),i(f,{type:"green",disabled:!n.localLicenseKey,loading:n.loading,onClick:m.processConnectOrActivate},{default:a(()=>[u(h(n.strings.connect),1)]),_:1},8,["disabled","loading","onClick"])]),n.error?(d(),S(C,{key:2,class:"license-key-error",type:"red",innerHTML:n.error},null,8,["innerHTML"])):g("",!0)]),_:1}),i(P)]),_:1})])}const xe=J($,[["render",le]]);export{xe as default};
